"use strict";(self.webpackChunk_portal_material_module=self.webpackChunk_portal_material_module||[]).push([["414"],{2755(){},5497(){},1580(e,l,t){t.r(l),t.d(l,{default:()=>m});var r=t(5723),s=t(8760),a=t(3271),n=t(5456),i=t(8670),o=t(8173),c=t(395),d=t.n(c),u=t(2833);function m(e){let{repo:l,value:t=[],onChange:c,limit:m=1,style:f,className:p,pickerType:x="drawer",defaultRatio:h=1.78}=e||{},[j,g]=(0,s.useState)(!1),k=!Array.isArray(t),v=k?[t]:t;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:d()("upload-form-input-container",p),style:f,children:[null==v?void 0:v.map((e,l)=>(0,r.jsxs)("div",{className:"flex items-center justify-center aspect-square rounded-md cursor-pointer relative",style:{background:"#efefef"},children:[(0,r.jsx)("img",{src:e,alt:"",className:"rounded-md"}),(0,r.jsx)(i.A,{theme:"filled",size:"18",fill:"#50e3c2",className:"absolute -top-2 -right-1 cursor-pointer",onClick:()=>{let e=[...v];e.splice(l,1),null==c||c(e)}})]},e)),(m>(null==v?void 0:v.length)||!(null==v?void 0:v.length))&&(0,r.jsx)("div",{onClick:()=>{g(!0)},className:"flex items-center justify-center space-x-2 aspect-square rounded-md cursor-pointer",style:{background:"#efefef"},children:(0,r.jsx)(o.A,{fill:"rgb(193, 193, 193)",size:32})})]}),"drawer"===x&&(0,r.jsx)(a.default,{repo:l,open:j,onClose:()=>{g(!1)},selectLimit:m-(null==t?void 0:t.length),onSelect:e=>{g(!1);let l=k?(0,u.ID)(e[0]):[...t||[],...e.map(e=>(0,u.ID)(e))];null==c||c(l)},features:[a.MaterialPickerFeature.Selector,a.MaterialPickerFeature.Uploader],source:"console"}),"modal"===x&&(0,r.jsx)(n.A,{repo:l,defaultRatio:h,open:j,onClose:()=>{g(!1)},selectLimit:m-(null==t?void 0:t.length),onSelect:e=>{g(!1);let l=k?(0,u.ID)(e[0]):[...t||[],...e.map(e=>(0,u.ID)(e))];null==c||c(l)}})]})}t(2755),t(3919)},5456(e,l,t){t.d(l,{A:()=>f});var r=t(5723),s=t(7109),a=t(4262),n=t(7362),i=t(1319),o=t(8760),c=t(9718),d=t(3271),u=t(7275);function m(e){let{repo:l,defaultRatio:t,open:c,onClose:d,selectLimit:m=1,onSelect:f}=e,[p,x]=(0,o.useState)({ratio:null==t?void 0:t.toString(),keyword:"",sorter:["updatedAt","DESC"]}),{dataSource:h,total:j,fetchNextPage:g,isLoading:k}=(0,i.A)({pn:1,ps:40,repo:l,keyword:p.keyword,ratio:p.ratio,sorter:p.sorter,status:1,enableRequest:c}),[v,y]=(0,o.useState)([]),b=(0,o.useMemo)(()=>v.map(e=>h.find(l=>l.id===e)).filter(e=>!!e),[v,h]);return(0,r.jsxs)(s.Modal,{width:980,title:null,footer:null,closable:!1,className:"material-modal",open:c,onCancel:d,onOk:d,okText:"确认",cancelText:"取消",centered:!0,children:[(0,r.jsx)(a.A,{title:"素材库",subtitle:`${h.length}/${j} 条素材`}),(0,r.jsx)(n.A,{dataSource:h,checkedIds:v,setCheckedIds:y,selectLimit:m,onLoadMore:()=>{g({})},isLoading:k,showCheckbox:!0,filterValue:p,onFilterChange:x,enablePreview:!1,enableEdit:!1}),(0,r.jsxs)("div",{style:{background:"#f8f8f9"},className:"p-4 flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("span",{className:"text-xs font-medium text-gray-900",children:0===b.length?"请选择素材":`已选择 ${b.length} 个素材`}),(0,r.jsx)("div",{className:"flex items-center gap-2",children:b.map(e=>(0,r.jsx)(u._,{src:`${e.prefix}/${e.fileKey}`,alt:e.fileName,className:"w-12 h-12 object-cover",backgroundColor:"var(--color-gray-200)",closeable:!0,onClose:()=>{y(v.filter(l=>l!==e.id))}},e.id))})]}),(0,r.jsx)("div",{children:(0,r.jsx)(s.Button,{type:"primary",onClick:()=>{null==f||f(b),y([]),d()},children:"确认选择"})})]})]})}function f(e){return(0,r.jsx)(c.Ht,{client:d.queryClient,children:(0,r.jsx)(m,{...e})})}t(5497)}}]);